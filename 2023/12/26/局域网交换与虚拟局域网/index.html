
    <!DOCTYPE html>
    <html lang="zh-CN"
            
          
    >
    <head>
    <meta charset="utf-8">
    

    

    
    <title>
        局域网交换与虚拟局域网 |
        
        EternalZero2022 的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CUbuntu%20Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
    
<link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/v4-font-face.min.css">

    
<link rel="stylesheet" href="/css/loader.css">

    <meta name="description" content="本文主要参考EagleBear2022的博客  局域网交换与虚拟局域网  1、交换机 网桥和路由器一般是通过软件来完成的，基于操作系统的。交换机是基于硬件的。 基本功能  根据MAC地址建立和维护交换表 将帧切换出接口到目标  对称交换（Symmetric Switching）：  可在相同带宽端口之间提供交换连接，但是用户访问其他网段上的服务器时可能会导致瓶颈  非对称交换（Asymmetric">
<meta property="og:type" content="article">
<meta property="og:title" content="局域网交换与虚拟局域网">
<meta property="og:url" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/index.html">
<meta property="og:site_name" content="EternalZero2022 的博客">
<meta property="og:description" content="本文主要参考EagleBear2022的博客  局域网交换与虚拟局域网  1、交换机 网桥和路由器一般是通过软件来完成的，基于操作系统的。交换机是基于硬件的。 基本功能  根据MAC地址建立和维护交换表 将帧切换出接口到目标  对称交换（Symmetric Switching）：  可在相同带宽端口之间提供交换连接，但是用户访问其他网段上的服务器时可能会导致瓶颈  非对称交换（Asymmetric">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/%E8%BD%AC%E5%8F%91%E6%96%B9%E5%BC%8F.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/BPDU.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/%E8%B7%AF%E5%BE%84%E4%BB%A3%E4%BB%B7.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/STP.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/%E9%AA%A8%E5%B9%B2%E7%BD%91.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/%E9%9D%99%E6%80%81vlan.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/%E5%8A%A8%E6%80%81vlan.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/%E5%B7%B2%E7%AB%AF%E5%8F%A3%E4%B8%BA%E4%B8%AD%E5%BF%83%E7%9A%84vlan.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/trunk.png">
<meta property="og:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B9%8B%E9%97%B4%E8%B7%AF%E7%94%B1.png">
<meta property="article:published_time" content="2023-12-26T14:36:34.000Z">
<meta property="article:modified_time" content="2023-12-26T14:36:45.391Z">
<meta property="article:author" content="EternalZero2022">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/p/%E8%BD%AC%E5%8F%91%E6%96%B9%E5%BC%8F.png">
    
        <link rel="alternate" href="/atom.xml" title="EternalZero2022 的博客" type="application/atom+xml">
    
    
        <link rel="shortcut icon" href="/images/favicon.ico">
    
    
        
<link rel="stylesheet" href="https://unpkg.com/typeface-source-code-pro@1.1.13/index.css">

    
    
<link rel="stylesheet" href="/css/style.css">

    
        
<link rel="stylesheet" href="https://unpkg.com/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

    
    
        
<link rel="stylesheet" href="https://unpkg.com/katex@0.16.7/dist/katex.min.css">

    
    
    
    
<script src="https://unpkg.com/pace-js@1.2.4/pace.min.js"></script>

    
        
<link rel="stylesheet" href="https://unpkg.com/wowjs@1.1.3/css/libs/animate.css">

        
<script src="https://unpkg.com/wowjs@1.1.3/dist/wow.min.js"></script>

        <script>
          new WOW({
            offset: 0,
            mobile: true,
            live: false
          }).init();
        </script>
    
<meta name="generator" content="Hexo 6.3.0"></head>

    <body>
    
<div id='loader'>
  <div class="loading-left-bg"></div>
  <div class="loading-right-bg"></div>
  <div class="spinner-box">
    <div class="loading-taichi">
      <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
      <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="#ff6e6b" />
      <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z" fill="#fd0d00" />
      <path d="M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95" fill="#fd0d00" />
    </svg>
    </div>
    <div class="loading-word">少女祈祷中...</div>
  </div>
</div>
</div>

<script>
  const endLoading = function() {
    document.body.style.overflow = 'auto';
    document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('load', endLoading);
  document.getElementById('loader').addEventListener('click', endLoading);
</script>


    <div id="container">
        <div id="wrap">
            <header id="header">
    
        <img data-src="/images/banner.jpg" data-sizes="auto" alt="局域网交换与虚拟局域网" class="lazyload">
    
    <div id="header-outer" class="outer">
        <div id="header-title" class="inner">
            <div id="logo-wrap">
                
                    
                    
                        <a href="/" id="logo"><h1>局域网交换与虚拟局域网</h1></a>
                    
                
            </div>
            
                
                
            
        </div>
        <div id="header-inner">
            <nav id="main-nav">
                <a id="main-nav-toggle" class="nav-icon"></a>
                
                    <span class="main-nav-link-wrap">
                        <span class="main-nav-icon"></span>
                        <a class="main-nav-link" href="/">首页</a>
                    </span>
                
                    <span class="main-nav-link-wrap">
                        <span class="main-nav-icon"></span>
                        <a class="main-nav-link" href="/archives">归档</a>
                    </span>
                
                    <span class="main-nav-link-wrap">
                        <span class="main-nav-icon"></span>
                        <a class="main-nav-link" href="/about">关于</a>
                    </span>
                
                    <span class="main-nav-link-wrap">
                        <span class="main-nav-icon"></span>
                        <a class="main-nav-link" href="/friend">友链</a>
                    </span>
                
            </nav>
            <nav id="sub-nav">
                
                    <a id="nav-rss-link" class="nav-icon" href="/atom.xml"
                       title="RSS 订阅"></a>
                
                
            </nav>
            <div id="search-form-wrap">
                <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://eternalzero2022.github.io"></form>
            </div>
        </div>
    </div>
</header>

            <div id="content" class="outer">
                <section id="main"><article id="post-局域网交换与虚拟局域网" class="h-entry article article-type-post"
         itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
    <div class="article-inner">
        <div class="article-meta">
            <div class="article-date wow slideInLeft">
    <a href="/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/" class="article-date-link">
        <time datetime="2023-12-26T14:36:34.000Z"
              itemprop="datePublished">2023-12-26</time>
    </a>
</div>

            

        </div>
        <div class="hr-line"></div>
        

        <div class="e-content article-entry" itemprop="articleBody">
            
                <p>本文主要参考<a target="_blank" rel="noopener" href="https://eaglebear2002.github.io/2022Spring-%E4%BA%92%E8%81%94%E7%BD%91%E8%AE%A1%E7%AE%97/%E4%BA%92%E8%81%94%E7%BD%91%E8%AE%A1%E7%AE%97-09-%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/">EagleBear2022的博客</a></p>
<h1 id="局域网交换与虚拟局域网"><a class="markdownIt-Anchor" href="#局域网交换与虚拟局域网"></a> 局域网交换与虚拟局域网</h1>
<h2 id="1-交换机"><a class="markdownIt-Anchor" href="#1-交换机"></a> 1、交换机</h2>
<p>网桥和路由器一般是通过软件来完成的，基于操作系统的。交换机是基于硬件的。</p>
<p><strong>基本功能</strong></p>
<ul>
<li>根据MAC地址建立和维护交换表</li>
<li>将帧切换出接口到目标</li>
</ul>
<p>对称交换（Symmetric Switching）：</p>
<ul>
<li>可在相同带宽端口之间提供交换连接，但是用户访问其他网段上的服务器时可能会导致瓶颈</li>
</ul>
<p>非对称交换（Asymmetric Switching）：</p>
<ul>
<li>通过将带有服务器的网段连接到更高带宽的端口（100Mbps）减少瓶颈的可能性</li>
<li>需要<strong>内存缓冲</strong></li>
</ul>
<p><strong>内存缓冲：</strong><br />
交换机中的内存区域，用于存储数据，直到数据可以从正确端口输出</p>
<p>基于端口的内存缓冲：（Port-based memory buffering）</p>
<ul>
<li>每个端口都有一个buffer，数据包存储在buffer中</li>
<li>在目标端口繁忙时，一个数据包可能会延迟其他数据包的传输</li>
<li>其他端口可能会空闲，从而产生不均衡问题</li>
</ul>
<p>共享内存缓冲：（Shared memory buffering）</p>
<ul>
<li>所有端口共享的公用内存缓冲</li>
<li>可以在不传到其他队列中的情况下从入端口传到出端口出去</li>
<li>需要记录自己的端口信息</li>
</ul>
<p><strong>交换方式：</strong><br />
1、储存转发（Store-and-Forward）</p>
<ul>
<li>交换机接收<strong>整个帧</strong>，最后校验CRC，然后再发往其他目的地</li>
<li>延迟可能会增加</li>
</ul>
<p>2、直通（Cut-through）</p>
<ul>
<li>减少延迟</li>
<li>分为两种：<br><br />
1、快速转发切换（Fast forward switching）：检查目标MAC，看到帧的目的地址就立即转发<br><br />
2、无碎片转发（Segment-free Switching）：在转发帧之前读取前 64 个字节以减少错误：避免碰撞和帧碎片</li>
</ul>
<p>三种转发方式比较</p>
<p><img src="p/%E8%BD%AC%E5%8F%91%E6%96%B9%E5%BC%8F.png" alt="" /></p>
<p>不同层次的交换机：</p>
<ul>
<li>第二层交换机：大规模集成电路，保证链路效率，有一个MAC地址</li>
<li>第三层交换机：基于硬件的转发机制，较高的帧转发性能（路由器基于路由表转发，是软件）；流控制，安全性更高，对数据流进行路由，生成 MAC 和 IP 的映射（消除了路由器对路由转发而导致的延时）</li>
<li>第四层交换机：可以根据端口主机的应用特点进行一定的流量控制</li>
</ul>
<p>一般我们只用到二层交换机；交换机可以简单识别第三层和第四次信息。</p>
<h2 id="2-生成树协议stp"><a class="markdownIt-Anchor" href="#2-生成树协议stp"></a> 2、生成树协议（STP）</h2>
<p>出于各种原因，网络中可能会出现环路。</p>
<ul>
<li>可能是故意冗余的结果，也可能是配置错误</li>
<li>可能带来的灾难：广播风暴（广播消息在网络中迅速传播并导致网络拥塞）、路由表错误</li>
</ul>
<p>往往是第二层交换机的冗余导致的桥回路。（以太网MAC帧没有TTL字段，循环后可能会继续下去）</p>
<h3 id="生成树协议综述"><a class="markdownIt-Anchor" href="#生成树协议综述"></a> 生成树协议综述</h3>
<p>主要功能：在交换机/桥接网络中允许冗余路径，而不会因环路的影响而引起延迟。</p>
<ul>
<li>通过计算稳定的生成树来防止回路</li>
<li>生成树帧（称为桥协议数据单元，bridge protocol data unit，BPDU）用于确定生成树拓扑。</li>
</ul>
<p>方式：在正常情况下禁用一些端口来防止出现冗余。</p>
<h4 id="stp名词解释"><a class="markdownIt-Anchor" href="#stp名词解释"></a> STP名词解释</h4>
<p>1、网桥ID（Bridge Identification，BID）</p>
<ul>
<li>8个字节</li>
<li>高阶子字段：2个字节，表示网桥优先级，在0-65535之间（默认为32768），10进制表示</li>
<li>低阶子字段：6个字节，表示分配给交换机的MAC地址，16进制表示</li>
</ul>
<p>2、STP成本值：成本越低越好</p>
<p>3、根路径成本：端口到根网桥（投票选出）的所有链接的累积成本</p>
<h4 id="stp决策顺序"><a class="markdownIt-Anchor" href="#stp决策顺序"></a> STP决策顺序</h4>
<ul>
<li>在拓扑里面最低的 root BID（选择具有<strong>最低BID</strong>的单个根交换机（先看网桥优先级，如果都相同则看MAC地址谁最低））</li>
<li>找到 Root bridge 的最低路径成本</li>
<li>每个路径都会选择一个最低 BID 的 sender 这个是针对一个链路的</li>
<li>每个路径再指定一个最低的 ID 端口</li>
</ul>
<h4 id="stp的bpdu帧"><a class="markdownIt-Anchor" href="#stp的bpdu帧"></a> STP的BPDU帧</h4>
<p><img src="p/BPDU.png" alt="" /></p>
<p>默认交换机每 2s 发送一次 BPDU，主要是维护最短的路径。</p>
<h4 id="路径代价"><a class="markdownIt-Anchor" href="#路径代价"></a> 路径代价</h4>
<p><img src="p/%E8%B7%AF%E5%BE%84%E4%BB%A3%E4%BB%B7.png" alt="" /></p>
<p>在图中，需要将链路转化为对应的路径代价</p>
<h4 id="5个stp状态"><a class="markdownIt-Anchor" href="#5个stp状态"></a> 5个STP状态</h4>
<p>只有在交换机做 STP 时，交换机才会出现这五个状态。</p>
<ul>
<li>阻塞：没有转发帧，听到了 BPDU</li>
<li>监听：不转发任何帧，监听数据帧（确定自己可以参加的交-  - 换），也会发送一些数据帧表示自己状态变了</li>
<li>学习：不转发帧，学习地址</li>
<li>转发：转发帧，学习地址</li>
<li>禁用：没有转发帧，没有听到 BPDU</li>
</ul>
<p>STP 过程：Blocking -&gt; 20s Listening -&gt; 15s Learning -&gt; 15s Fowarding 或者 Disabled</p>
<h4 id="初始stp收敛过程"><a class="markdownIt-Anchor" href="#初始stp收敛过程"></a> 初始STP收敛过程：</h4>
<p>1、选举根交换机（根网桥，root switch）</p>
<ul>
<li>每个交换机<strong>先宣布自己为根</strong></li>
<li>交换信息，检查端口上所有BPDU以及在该端口上发送的所有BPDU，如果一个BPDU中的BID小于自己的，就替换自己的旧值并且这一BPDU的发送者被<strong>接受为新的根</strong></li>
</ul>
<p>2、选择根端口（root ports）</p>
<ul>
<li>每个<strong>非根桥</strong>必须选择<strong>一个</strong>根端口。注意根桥不用选。</li>
<li>桥的根端口是最接近根桥的端口。（即从这个端口出发到根端口最近的一个端口）</li>
<li>STP成本在BPDU被接收到时增加，而不是在将BPDU发送出去时增加。</li>
</ul>
<p>3、选择指定端口（Designated Port）</p>
<ul>
<li>每个<strong>网段</strong>都有一个指定端口。（注意区别，根端口是每个非根桥有一个，指定端口是每个网段有一个）</li>
<li>需要选择的是每个端口中，所在的路由器的根端口的STP成本最小的那个端口</li>
<li>该端口既向该网段又向根网桥发送流量，也从该网段和根网桥接收流量。</li>
<li>其他未被指定的端口就被block了。</li>
</ul>
<p>完成这三步后，剩下的所有端口组合在一起就形成了一个最小生成树</p>
<p><img src="p/STP.png" alt="" /></p>
<h2 id="3-虚拟局域网vlan"><a class="markdownIt-Anchor" href="#3-虚拟局域网vlan"></a> 3、虚拟局域网VLAN</h2>
<p>为什么引入虚拟局域网？</p>
<p>随着网络数的增多，又由于交换机无法分割广播域，每个交换机在广播时需要发送到网络的每个角落，严重影响网络性能（广播风暴）。因此需要把一个大的广播域划分为几个小的广播域。而路由器会直接在网络层上分段将网络隔离，导致网络规划复杂，因此使用VLAN代替，解决二层问题。</p>
<h3 id="vlan简介"><a class="markdownIt-Anchor" href="#vlan简介"></a> vlan简介</h3>
<ul>
<li>
<p>根据不同指标（部门、功能等）对用户进行<strong>逻辑分组</strong>（区别于路由器的物理分组）</p>
</li>
<li>
<p>VLAN在第二第三层工作，控制网络广播，允许用户由网络管理员分配</p>
</li>
<li>
<p>VLAN创建一个不限于物理网段的单个广播域，将其视为子网</p>
</li>
</ul>
<p>优点：</p>
<ul>
<li>限制广播包，提高带宽的利用率。</li>
<li>创建虚拟工作组：可以一个部门工作的人划分为一个 VLAN，这样子即使他移动了办公位置，仍然能够正常办公</li>
<li>增强通信的安全性：其他 VLAN 用户网络收不到非本 VLAN 的报文，避免被监听</li>
</ul>
<p>分组用户：广播帧只有在具有相同 VLAN ID 的一个或多个交换机的端口之间切换（VLAN ID 属于端口）</p>
<p>可以通过基于以下内容的软件对用户进行逻辑分组（即作为一种划分参考来人为划分）：</p>
<ul>
<li>端口号</li>
<li>MAC 地址</li>
<li>使用的协议</li>
<li>使用的应用</li>
</ul>
<p>第三层交换机：为每一个网段设置一个 SVI（switch virtual interface，虚拟交换机结构，也可以理解为子接口），通过这个来进行不同网段之间的通信</p>
<h3 id="vlan的结构"><a class="markdownIt-Anchor" href="#vlan的结构"></a> VLAN的结构</h3>
<p>vlan通过骨干网：</p>
<p><img src="p/%E9%AA%A8%E5%B9%B2%E7%BD%91.png" alt="" /></p>
<ul>
<li>骨干网是用于 VLAN 间通信的区域，可以跑多个 VLAN，应该是高速链路</li>
</ul>
<p>vlan中路由器：提供不同 VLAN 之间的连接。不能广播，但是VLAN1 上的用户可以向 VLAN2 上的用户发送电子邮件</p>
<p>在 VLAN 中的帧的使用：</p>
<ul>
<li>帧过滤（Frame Filtering）：交换机检查有关每个帧的特定信息（MAC 地址或第三层协议类型），特定的 VLAN 记录或者映射</li>
<li>帧标记（Frame Tagging）：在整个网络骨干网中转发时，交换机在每个帧的标题中放置一个唯一的标识符。当帧离开网络骨干网时，交换机会在帧发送到目标终端站之前删除标识符。只和端口绑定，而不影响主机。帧标记只在第二层起作用</li>
</ul>
<h4 id="ieee8021q-和-isl"><a class="markdownIt-Anchor" href="#ieee8021q-和-isl"></a> IEEE802.1Q 和 ISL</h4>
<p>IEEE802.1Q：IEEE 标准，在标头中插入 VLAN 的标签以标识所属的 VLAN（帧标记）</p>
<p>ISL（Inter-Switch Link）：思科专有。ISL 在数据帧的前面添加一个 26 字节的标头，并在末尾附加一个 CRC（4 字节）。</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Encapsulation</th>
<th>Label</th>
<th>Media</th>
</tr>
</thead>
<tbody>
<tr>
<td>802.1Q</td>
<td>No</td>
<td>Yes</td>
<td>Ethernet</td>
</tr>
<tr>
<td>ISL</td>
<td>Yes</td>
<td>No</td>
<td>Ethernet</td>
</tr>
</tbody>
</table>
<h3 id="vlan的实现"><a class="markdownIt-Anchor" href="#vlan的实现"></a> vlan的实现</h3>
<h4 id="静态vlan"><a class="markdownIt-Anchor" href="#静态vlan"></a> 静态vlan</h4>
<p>交换机上的端口以管理方式分配给 VLAN（管理员手动配置）</p>
<ul>
<li>安全，易于配置和监控，在控制移动的网络中效果很好</li>
</ul>
<p><img src="p/%E9%9D%99%E6%80%81vlan.png" alt="" /></p>
<h4 id="动态vlan"><a class="markdownIt-Anchor" href="#动态vlan"></a> 动态vlan</h4>
<p>一个服务器来配置 VLAN 的信息。</p>
<p><img src="p/%E5%8A%A8%E6%80%81vlan.png" alt="" /></p>
<p>交换机通过 MAC 地址或者哪一个协议，指定是哪一个 VLAN。</p>
<p>当工作站最初连接到未分配的端口时，交换机会检查表中的条目，并使用正确的 VLAN 动态配置端口。</p>
<h4 id="以端口为中心的vlan"><a class="markdownIt-Anchor" href="#以端口为中心的vlan"></a> 以端口为中心的vlan</h4>
<p><img src="p/%E5%B7%B2%E7%AB%AF%E5%8F%A3%E4%B8%BA%E4%B8%AD%E5%BF%83%E7%9A%84vlan.png" alt="" /></p>
<p>同一 VLAN 中的所有节点都连接到同一路由器接口</p>
<p>管理更容易，因为：</p>
<ul>
<li>通过路由器端口分配用户</li>
<li>VLAN 易于管理</li>
<li>提供更高的安全性</li>
<li>数据包不会“泄漏”到其他域</li>
</ul>
<h4 id="接入链路和骨干链路"><a class="markdownIt-Anchor" href="#接入链路和骨干链路"></a> 接入链路和骨干链路</h4>
<p>1、接入链路（Access Links）：通过一个vlan报文，仅作为一个 VLAN 成员的交换机上的连接。</p>
<p>此 VLAN 被称为端口的本机 VLAN，连接到端口的任何设备都完全不知道 VLAN 存在。</p>
<p>2、骨干链路（Trunk Links）：通过多个 VLAN 报文，能够支持多个 VLAN，通常用于将交换机连接到其他交换机或路由器。</p>
<p><img src="p/trunk.png" alt="" /></p>
<ul>
<li>骨干是支持多个 VLAN 的点对点链接</li>
<li>骨干用于在两个实现 VLAN 的设备之间创建链接时节省端口</li>
<li>骨干链路不属于特定的 VLAN：充当交换机和路由器之间 VLAN 的通道。</li>
<li>可以将骨干链路配置为传输所有 VLAN 或有限数量的 VLAN。</li>
</ul>
<h4 id="交换机29xx中的配置"><a class="markdownIt-Anchor" href="#交换机29xx中的配置"></a> 交换机29xx中的配置</h4>
<ul>
<li>VLAN 1 是出厂默认 VLAN 之一，是默认的以太网vlan</li>
<li>思科发现协议（CDP）和 VLAN 骨干协议（VTP）通告在 VLAN 1 上发送。</li>
</ul>
<h3 id="vlan配置命令"><a class="markdownIt-Anchor" href="#vlan配置命令"></a> vlan配置命令</h3>
<p>1、创建vlan</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Switch# vlan database</span><br><span class="line">Switch(vlan)# vlan [vlan_number]</span><br><span class="line">Switch(vlan)# exit</span><br></pre></td></tr></table></figure>
<p>2、将VLAN分配给一个或多个接口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Switch(config)# interface fastethernet 0/9</span><br><span class="line">Switch(config-if)# switchport access vlan vlan_number</span><br></pre></td></tr></table></figure>
<p>3、添加vlan</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cat2950#vlan database</span><br><span class="line">cat2950(vlan)#vlan 9 name switchlab90</span><br><span class="line">VLAN 9 added:</span><br><span class="line">   Name: switchlab90</span><br><span class="line">cat2950(vlan)#?</span><br><span class="line">VLAN database editing buffer manipulation commands：</span><br><span class="line">    abort Exit mode without applying the changes</span><br><span class="line">    apply Apply current changes and bump revision number</span><br><span class="line">    exit Apply changes, bump revision number, and exit mode</span><br><span class="line">    reset Abandon current changes and reread current database Adding a VLAN Example</span><br><span class="line">cat2950(config)#interface fa 0/2</span><br><span class="line">cat2950(config-if)# switchport access vlan 9</span><br></pre></td></tr></table></figure>
<p>4、验证vlan</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Switch# show vlan [vlanid]</span><br></pre></td></tr></table></figure>
<p>5、删除vlan</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">switch（vlan）# no vlan vlanid [name /vlan-name]</span><br></pre></td></tr></table></figure>
<h4 id="在局域网之间的路由"><a class="markdownIt-Anchor" href="#在局域网之间的路由"></a> 在局域网之间的路由</h4>
<p><img src="p/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B9%8B%E9%97%B4%E8%B7%AF%E7%94%B1.png" alt="" /></p>
<p>每个端口连接一个 VLAN，每个 IP 和一个 VLAN 连接</p>
<p>方法：将路由器上的端口划分为三个子端口Fa0/0.1、Fa0/0.2 和 Fa0/0.3</p>
<p>配置vlan间路由：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Sydney(config)#interface FastEthernet 0/0</span><br><span class="line">Sydney(config-if)#full duplex 全双工</span><br><span class="line">Sydney(config-if)#no shut</span><br><span class="line">Sydney(config-if)#interface FastEthernet 0/0.1</span><br><span class="line"></span><br><span class="line">Sydney(config-subif)#encapsulation 802.1q 1</span><br><span class="line">Sydney(config-subif)#ip address 192.168.1.1 255.255.255.0</span><br><span class="line">Sydney(config-if)#interface FastEthernet 0/0.2</span><br><span class="line"></span><br><span class="line">Sydney(config-subif)#encapsulation 802.1q 20</span><br><span class="line">Sydney(config-subif)#ip address 192.168.2.1 255.255.255.0</span><br><span class="line">Sydney(config-if)#interface FastEthernet 0/0.3</span><br><span class="line"></span><br><span class="line">Sydney(config-subif)#encapsulation 802.1q 30</span><br><span class="line">Sydney(config-subif)#ip address 192.168.3.1 255.255.255.0</span><br></pre></td></tr></table></figure>
<p>注意：如果是 Trunk Link：应该使用<strong>交叉线</strong>，而不是直通线；如果是 Access Link：<strong>直通线</strong></p>

            
        </div>
        <footer class="article-footer">
            <a data-url="https://eternalzero2022.github.io/2023/12/26/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BA%A4%E6%8D%A2%E4%B8%8E%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91/" data-id="clqmgawff0000j0uwf6fj811r" data-title="局域网交换与虚拟局域网"
               class="article-share-link">分享</a>
            
            
            
            

        </footer>
    </div>
    
        
    <nav id="article-nav" class="wow fadeInUp">
        
            <div class="article-nav-link-wrap article-nav-link-left">
                
                    
                    
                        <img data-src="https://d-sketon.top/img/backimg/bg1.jpg" data-sizes="auto" alt="广域网" class="lazyload">
                    
                
                <a href="/2023/12/27/%E5%B9%BF%E5%9F%9F%E7%BD%91/"></a>
                <div class="article-nav-caption">前一篇</div>
                <h3 class="article-nav-title">
                    
                        广域网
                    
                </h3>
            </div>
        
        
            <div class="article-nav-link-wrap article-nav-link-right">
                
                    
                    
                        <img data-src="https://d-sketon.top/img/backimg/bg1.jpg" data-sizes="auto" alt="路由协议" class="lazyload">
                    
                
                <a href="/2023/12/26/%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE/"></a>
                <div class="article-nav-caption">后一篇</div>
                <h3 class="article-nav-title">
                    
                        路由协议
                    
                </h3>
            </div>
        
    </nav>


    
</article>











</section>
                
                    <aside id="sidebar">
    <div class="sidebar-wrap wow fadeInRight">
        <div class="sidebar-author">
            <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="EternalZero2022" class="lazyload">
            <div class="sidebar-author-name">EternalZero2022</div>
            <div class="sidebar-description">卑微软工狗一个，属于德克萨斯小姐</div>
        </div>
        <div class="sidebar-state">
            <div class="sidebar-state-article">
                <div>文章</div>
                <div class="sidebar-state-number">69</div>
            </div>
            <div class="sidebar-state-category">
                <div>分类</div>
                <div class="sidebar-state-number">3</div>
            </div>
            <div class="sidebar-state-tag">
                <div>标签</div>
                <div class="sidebar-state-number">0</div>
            </div>
        </div>
        <div class="sidebar-social">
            
                <div class=icon-github>
                    <a href=https://github.com/eternalzero2022 itemprop="url" target="_blank"></a>
                </div>
            
                <div class=icon-google>
                    <a href=https://plus.google.com/yourname itemprop="url" target="_blank"></a>
                </div>
            
                <div class=icon-twitter>
                    <a href=https://twitter.com/yourname itemprop="url" target="_blank"></a>
                </div>
            
                <div class=icon-facebook>
                    <a href=https://www.facebook.com/yourname itemprop="url" target="_blank"></a>
                </div>
            
        </div>
        <div class="sidebar-menu">
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">首页</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/archives"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">归档</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/about"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">关于</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/friend"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">友链</div>
                </div>
            
        </div>
    </div>
    
        
    <div class="widget-wrap wow fadeInRight">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A8%B1%E4%B9%90/">娱乐</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BB%8F%E9%AA%8C-%E6%9D%82%E8%B0%88/">经验/杂谈</a></li></ul>
        </div>
    </div>


    
        

    
        
    <div class="widget-wrap wow fadeInRight">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">十二月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">十月 2023</a></li></ul>
        </div>
    </div>


    
</aside>

                
            </div>
            <footer id="footer" class="wow fadeInUp">
    <div style="width: 100%; overflow: hidden"><div class="footer-line"></div></div>
    <div class="outer">
        <div id="footer-info" class="inner">
            
            <div>
                <span class="icon-copyright"></span>
                2020-2024
                <span class="footer-info-sep"></span>
                EternalZero2022
            </div>
            
                <div>
                    基于&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>&nbsp;
                    Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" target="_blank">Reimu</a>
                </div>
            
            
                <div>
                    <span class="icon-brush"></span>
                    179.9k
                    &nbsp;|&nbsp;
                    <span class="icon-coffee"></span>
                    10:47
                </div>
            
            
                <div>
                    <span class="icon-eye"></span>
                    <span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span>
                    &nbsp;|&nbsp;
                    <span class="icon-user"></span>
                    <span id="busuanzi_container_site_uv">总访客量&nbsp;<span id="busuanzi_value_site_uv"></span></span>
                </div>
            
        </div>
    </div>
</footer>

        </div>
        <nav id="mobile-nav">
    <div class="sidebar-wrap">
        <div class="sidebar-author">
            <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="EternalZero2022" class="lazyload">
            <div class="sidebar-author-name">EternalZero2022</div>
            <div class="sidebar-description">卑微软工狗一个，属于德克萨斯小姐</div>
        </div>
        <div class="sidebar-state">
            <div class="sidebar-state-article">
                <div>文章</div>
                <div class="sidebar-state-number">69</div>
            </div>
            <div class="sidebar-state-category">
                <div>分类</div>
                <div class="sidebar-state-number">3</div>
            </div>
            <div class="sidebar-state-tag">
                <div>标签</div>
                <div class="sidebar-state-number">0</div>
            </div>
        </div>
        <div class="sidebar-social">
            
                <div class=icon-github>
                    <a href=https://github.com/eternalzero2022 itemprop="url" target="_blank"></a>
                </div>
            
                <div class=icon-google>
                    <a href=https://plus.google.com/yourname itemprop="url" target="_blank"></a>
                </div>
            
                <div class=icon-twitter>
                    <a href=https://twitter.com/yourname itemprop="url" target="_blank"></a>
                </div>
            
                <div class=icon-facebook>
                    <a href=https://www.facebook.com/yourname itemprop="url" target="_blank"></a>
                </div>
            
        </div>
        <div class="sidebar-menu">
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">首页</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/archives"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">归档</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/about"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">关于</div>
                </div>
            
                <div class="sidebar-menu-link-wrap">
                    <a class="sidebar-menu-link-dummy" href="/friend"></a>
                    <span class="sidebar-menu-icon"></span>
                    <div class="sidebar-menu-link">友链</div>
                </div>
            
        </div>
    </div>
</nav>

        
<script src="https://unpkg.com/jquery@3.7.0/dist/jquery.min.js"></script>


<script src="https://unpkg.com/lazysizes@5.3.2/lazysizes.min.js"></script>


<script src="https://unpkg.com/clipboard@2.0.11/dist/clipboard.min.js"></script>



    
<script src="https://unpkg.com/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>



    
<script src="https://unpkg.com/busuanzi@2.3.0/bsz.pure.mini.js"></script>






<script src="/js/script.js"></script>
















    </div>
    <div class="site-search">
        <div class="algolia-popup popup">
            <div class="algolia-search">
                <span class="algolia-search-input-icon"></span>
                <div class="algolia-search-input" id="algolia-search-input"></div>
            </div>

            <div class="algolia-results">
                <div id="algolia-stats"></div>
                <div id="algolia-hits"></div>
                <div id="algolia-pagination" class="algolia-pagination"></div>
            </div>

            <span class="popup-btn-close"></span>
        </div>
    </div>
    <!-- hexo injector body_end start -->
<script src="/js/insertHighlight.js"></script>
<!-- hexo injector body_end end --></body>
    </html>

